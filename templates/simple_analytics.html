{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-12 text-center">
        <h2 class="display-5 fw-bold text-white mb-3">Business Analytics</h2>
    </div>
</div>

<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="metric-card" style="background: linear-gradient(135deg, #10b981, #059669);">
            <i class="fas fa-dollar-sign fa-2x mb-3"></i>
            <h3>PKR {{ data.total_revenue }}</h3>
            <p class="mb-0 opacity-75">Total Revenue</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="metric-card" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
            <i class="fas fa-receipt fa-2x mb-3"></i>
            <h3>PKR {{ data.total_expenses }}</h3>
            <p class="mb-0 opacity-75">Total Expenses</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="metric-card" style="background: linear-gradient(135deg, #6366f1, #4f46e5);">
            <i class="fas fa-shopping-cart fa-2x mb-3"></i>
            <h3>{{ data.total_sales }}</h3>
            <p class="mb-0 opacity-75">Total Sales</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="metric-card" style="background: linear-gradient(135deg, {% if data.net_profit >= 0 %}#10b981, #059669{% else %}#ef4444, #dc2626{% endif %});">
            <i class="fas fa-chart-line fa-2x mb-3"></i>
            <h3>PKR {{ data.net_profit }}</h3>
            <p class="mb-0 opacity-75">Net Profit</p>
        </div>
    </div>
</div>

<div class="row g-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Profit Analysis</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <strong>Revenue:</strong> 
                    <span class="text-success">PKR {{ data.total_revenue }}</span>
                </div>
                <div class="mb-3">
                    <strong>Expenses:</strong> 
                    <span class="text-warning">-PKR {{ data.total_expenses }}</span>
                </div>
                <hr>
                <div class="mb-3">
                    <strong>Net Profit:</strong> 
                    <span class="{% if data.net_profit >= 0 %}text-success{% else %}text-danger{% endif %}">
                        {% if data.net_profit >= 0 %}+{% endif %}PKR {{ data.net_profit }}
                    </span>
                </div>
                <div class="progress">
                    <div class="progress-bar {% if data.net_profit >= 0 %}bg-success{% else %}bg-danger{% endif %}" 
                         style="width: {{ ((data.net_profit|abs / (data.total_revenue + 1)) * 100)|round }}%"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Business Insights</h5>
            </div>
            <div class="card-body">
                <div class="alert {% if data.net_profit >= 0 %}alert-success{% else %}alert-danger{% endif %}">
                    <h6>Financial Status:</h6>
                    {% if data.net_profit >= 0 %}
                        <p class="mb-0">✅ Your business is profitable! Keep up the good work.</p>
                    {% else %}
                        <p class="mb-0">⚠️ Your business is running at a loss. Consider reducing expenses or increasing sales.</p>
                    {% endif %}
                </div>
                
                <div class="row text-center mt-3">
                    <div class="col-6">
                        <h6>Average Sale</h6>
                        <p class="text-muted">PKR {{ (data.total_revenue / data.total_sales)|round(2) if data.total_sales > 0 else 0 }}</p>
                    </div>
                    <div class="col-6">
                        <h6>Profit Margin</h6>
                        <p class="text-muted">{{ ((data.net_profit / data.total_revenue) * 100)|round(2) if data.total_revenue > 0 else 0 }}%</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}